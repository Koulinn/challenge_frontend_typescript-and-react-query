import React from 'react';

// components
import { Modal, Texts } from 'components/atoms';

// Types
import { VulnerabilityDataType } from 'types/VulnerabilitiesTypes';
import {
    Badge,
    Box,
    ModalBody,
    ModalCloseButton,
    ModalFooter,
    ModalHeader,
    Stack,
    Text,
} from '@chakra-ui/react';

function VulnerabilityModal(props: {
    vulnerabilityCard: VulnerabilityDataType;
    setVulnerabilityCard: (
        prev: VulnerabilityDataType | null
    ) => VulnerabilityDataType | null | void;
}) {
    const {
        name,
        severity,
        category,
        description,
        remediation,
        exploit_available,
        cvss_score,
        cvss3_score,
        // external_links,
        nessus_plugin_family,
        created_at,
        updated_at,
        additional_affected_asset_fields,
    } = props.vulnerabilityCard;

    const isOpen = props.vulnerabilityCard !== null;
    const onClose = () => props.setVulnerabilityCard(null);

    return (
        <Modal isOpen={isOpen} onClose={onClose}>
            <ModalHeader>
                <Text as={'h2'} fontSize={'3xl'}>
                    {name}
                </Text>
                <ModalCloseButton />
            </ModalHeader>
            <ModalBody>
                <Box>
                    <Badge marginBottom={'8'}>{severity}</Badge>
                </Box>
                <Stack spacing={'3'}>
                    <Text as={'b'} fontSize={'xl'}>
                        {category}
                    </Text>
                    <Box>
                        <Texts.Label>Description:</Texts.Label>
                        <Texts.Paragraph>{description}</Texts.Paragraph>
                    </Box>
                    <Box>
                        <Texts.Label>Remediation:</Texts.Label>
                        <Texts.Paragraph>{remediation}</Texts.Paragraph>
                    </Box>
                    <Box>
                        <Texts.Label>Exploits:</Texts.Label>

                        <Texts.Paragraph>{exploit_available}</Texts.Paragraph>
                    </Box>
                    <Box>
                        <Texts.Label>CVSS:</Texts.Label>

                        <Texts.Paragraph>{cvss_score}</Texts.Paragraph>
                    </Box>
                    <Box>
                        <Texts.Label>CVSS3:</Texts.Label>

                        <Texts.Paragraph>{cvss3_score}</Texts.Paragraph>
                    </Box>
                </Stack>
            </ModalBody>
            <ModalFooter>
                <Stack spacing={'2'}>
                    <Box>
                        <Texts.Label>Nessus plugin:</Texts.Label>

                        <Texts.Paragraph>
                            {nessus_plugin_family}
                        </Texts.Paragraph>
                    </Box>
                    <Box>
                        <Texts.Label>Affected assets:</Texts.Label>

                        {additional_affected_asset_fields.map((field) => (
                            <Texts.Paragraph key={field}>
                                {field}
                            </Texts.Paragraph>
                        ))}
                    </Box>
                    <Box>
                        <Texts.Label>Created:</Texts.Label>
                        <Texts.Paragraph>{created_at}</Texts.Paragraph>
                        <Texts.Label>Last update:</Texts.Label>

                        <Texts.Paragraph>{updated_at}</Texts.Paragraph>
                    </Box>
                </Stack>
            </ModalFooter>
        </Modal>
    );
}

export default VulnerabilityModal;
